<!DOCTYPE html>
<html>
    <head>
        <title>Dashboard</title>
        <link rel="stylesheet" type="text/css" href="/dashboard.css" />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
            rel="stylesheet" />
        <link
            href="https://getbootstrap.com/docs/5.3/assets/css/docs.css"
            rel="stylesheet" />
        <link rel="stylesheet" href="/project.css" />
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        <link
            rel="stylesheet"
            type="text/css"
            href="/dashboard_no_projects.css" />
        <link rel="icon" type="image/x-icon" href="/images/favicon.png" />
    </head>
    
    <body>
        <div class="no-project header center">
            <h1 style="text-align: center;">Issue Tracker App</h1><br><br>
            <h1>Hello <%= userData.username %>,</h1>
            <a
                href="/client/users/createProject/<%= userData._id %>"
                class="btn">
                Create New Project<span></span
            ></a>
            <button class="btn btn-outline-danger" onclick="logout()">
                Logout
            </button>
        </div>
        <div class="list">
            <ul class="card-columns">
                <% dashboardData.forEach(function(data) { %>
                <li class="card">
                    <a href="/client/users/project/<%= data.project.id %>">
                        <div class="card-body">
                            <h5 class="card-title">
                                <%= data.project.projectName %>
                            </h5>
                            <h6 class="card-subtitle mb-2 text-muted">
                                <%= data.createdAt %>
                            </h6>
                            <p class="card-text">
                                <%= data.project.projectDescription %>
                            </p>
                            <p style="color: #2691d9" class="card-link">
                                <%= data.fixedIssues %> of <%= data.totalIssues
                                %> Issues fixed
                            </p>
                        </div>
                    </a>
                </li>
                <% }); %>
            </ul>
        </div>

        <script>
            if (localStorage.getItem("token")) {
            } else {
                window.location.href = "/client/users/login";
            }
            window.addEventListener("pageshow", function (event) {
                var historyTraversal =
                    event.persisted ||
                    (typeof window.performance != "undefined" &&
                        window.performance.navigation.type === 2);
                if (historyTraversal) {
                    // Handle page restore.
                    window.location.reload();
                }
            });
        </script>
        <script src="/project.js"></script>
    </body>
</html>
